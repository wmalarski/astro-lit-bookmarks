---
import { buttonRecipe } from "@recipes/Button.recipe";

export type Props = {
  title: string;
  text: string;
  url: string;
};

const { url, text, title } = Astro.props;
---

<share-bookmark-button
  type="button"
  class={buttonRecipe()}
  url={url}
  text={text}
  title={title}
>
  Share
</share-bookmark-button>

<script>
  class ShareBookmarkButton extends HTMLButtonElement {
    constructor() {
      super();
    }

    onShareClick() {
      navigator.share({
        url: this.getAttribute("url")!,
        text: this.getAttribute("text")!,
        title: this.getAttribute("title")!,
      });
    }

    connectedCallback() {
      this.addEventListener("click", this.onShareClick);
    }

    disconnectedCallback() {
      this.removeEventListener("click", this.onShareClick);
    }
  }

  customElements.define("share-bookmark-button", ShareBookmarkButton, {
    extends: "button",
  });
</script>
